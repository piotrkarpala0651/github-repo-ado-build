name: Label Triggered Workflow

on:
  pull_request:
    types: [labeled, unlabeled]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout code
      uses: actions/checkout@v2

    - name: Add comment to fix PR title
      uses: marocchino/sticky-pull-request-comment@v2
      if: github.event.action == 'labeled' && contains(github.event.pull_request.labels.*.name, 'title needs formatting')
      with:
        header: 'PR Title Check'
        recreate: true
        message: |
            ### ðŸš¨ PR Title Needs Formatting ðŸš¨
            The title of this PR needs to be formatted correctly and include an Azure Boards Reference. 
            Please update the title to match the format `type: description AB#xxx`. Examples:
            * `bugfix: fix typo in README.md AB#123`
            * `chore: update dependencies AB#456`
            * `feat: add new feature AB#789`
            * `chore: fixing build pipeline` - no AB reference

    - name: Add comment that PR title is fixed
      if: github.event.action == 'unlabeled' && contains(github.event.pull_request.labels.*.name, 'title needs formatting')
      uses: marocchino/sticky-pull-request-comment@v2
      with:
        header: 'PR Title Check'
        recreate: true
        message: |
            ### âœ… PR Title Fixed âœ…
            The title of this PR has been updated to match the correct format. Thank you! 